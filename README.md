# Google-Sheet-Auto-Accounting-Bot
全自動記帳系統：Gmail 抓信 + Google Sheet 支出分析
# 💰 全自動記帳系統 (Google Apps Script)

這是一個基於 Google Apps Script 的自動化記帳工具。它能自動監控 Gmail 中的銀行消費通知，將資料解析並寫入 Google Sheet，並自動生成視覺化的年度戰情室與互動式明細查詢面板。

## ✨ 主要功能

* **📧 自動抓取**：監控 Gmail 特定銀行（預設為國泰世華）的消費通知信。
* **🤖 智慧分類**：內建關鍵字庫，自動將消費歸類（如：餐飲、交通、數位娛樂...）。
* **📊 年度戰情室**：自動生成年度矩陣報表，統計每月各類別支出。
* **🔍 互動查詢面板**：透過下拉選單即時查詢特定年份與類別的詳細消費紀錄。
* **📱 iOS 捷徑支援**：提供 API 接口，可配合 iOS 捷徑進行手動記帳。
* **🔄 倒序排列**：新資料自動插入至表格最上方，閱讀更直觀。

## 🛠️ 安裝方式

1. 建立一個新的 Google Sheet。
2. 點選 `擴充功能` > `Apps Script`。
3. 將 `Code.gs` 的內容複製並貼上。
4. 儲存後，重新整理試算表，上方會出現「💰 記帳小幫手」選單。
5. (選用) 在 Apps Script 設定「觸發條件」，讓系統每小時自動執行抓信。

## ⚙️ 設定

你可以在程式碼上方的 `CONFIG` 區域調整：
* `CATEGORIES`: 自定義分類關鍵字。
* `EMAIL_QUERY`: 修改監控的銀行信件來源。

## 📝 版本紀錄

* **v5.5**: 新增互動式查詢面板總計功能、修復報表格式問題。
* **v5.0**: 加入倒序插入功能、統一分類邏輯。
